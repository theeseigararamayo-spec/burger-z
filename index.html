<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Burger App Pedidos</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        /* --- Paleta de Colores Dark Mode --- */
        :root {
            --primary: #6200EE;    /* Violeta Principal */
            --secondary: #03DAC6;  /* Azul/Turquesa Acento */
            --background: #121212; /* Negro Oscuro */
            --card-bg: #1F1F1F;    /* Gris Oscuro para Tarjetas */
            --text-light: #FFFFFF;
            --text-dark: #BBBBBB;
            --success: #018786;    /* Verde para WhatsApp */
            --danger: #CF6679;     /* Rojo para Borrar */
        }

        /* --- Estilos Base --- */
        body {
            font-family: 'Montserrat', sans-serif;
            background: linear-gradient(135deg, var(--background) 0%, #000000 100%);
            margin: 0;
            padding: 0;
            color: var(--text-dark);
            padding-bottom: 110px;
            transition: background 0.5s;
        }

        /* --- Encabezado --- */
        header {
            background-color: var(--primary);
            color: var(--text-light);
            padding: 15px;
            text-align: center;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.5);
            position: sticky;
            top: 0;
            z-index: 100;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        header h1 { 
            margin: 0; 
            font-size: 1.8rem; 
            font-weight: 900; 
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* --- LOGO ANIMADO 3D --- */
        .header-logo {
            font-size: 2.2rem; /* Tama√±o de la hamburguesa emoji */
            display: inline-block; /* Para que la animaci√≥n funcione */
            animation: rotate3D 6s infinite linear; /* Animaci√≥n */
            filter: drop-shadow(0 0 8px var(--secondary)); /* Sombra para resaltar */
        }

        @keyframes rotate3D {
            0% { transform: perspective(500px) rotateY(0deg); }
            50% { transform: perspective(500px) rotateY(360deg); }
            100% { transform: perspective(500px) rotateY(0deg); }
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
        }

        /* --- PRODUCTOS (HAMBURGUESAS) --- */
        .product-card {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 25px;
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.4);
            display: flex;
            flex-direction: column;
            align-items: center;
            border: 1px solid rgba(255, 255, 255, 0.05);
            transition: transform 0.2s;
        }
        .product-card:active { transform: scale(0.98); }

        /* --- Estilos para las IMAGENES de PRODUCTO --- */
        .product-img-wrapper {
            width: 150px; /* Tama√±o del contenedor de la imagen */
            height: 150px;
            margin-bottom: 15px;
            border-radius: 50%; /* Opcional: para hacer las im√°genes circulares */
            overflow: hidden; /* Recorta la imagen si es circular */
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #2a2a2a; /* Fondo si la imagen no llena */
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5), 0 0 20px var(--secondary); /* Sombra y brillo */
        }
        .product-img-wrapper img {
            width: 100%; /* Ajusta la imagen al contenedor */
            height: 100%;
            object-fit: cover; /* Mantiene la proporci√≥n y cubre el √°rea */
            display: block;
        }

        .product-info { text-align: center; width: 100%; }
        .product-info h2 { margin: 5px 0; font-size: 1.5rem; color: var(--text-light); }
        .product-info p { color: var(--text-dark); font-size: 0.95rem; margin-bottom: 15px; }
        .price { font-weight: bold; font-size: 1.4rem; color: var(--secondary); }

        .btn-customize {
            background-color: var(--secondary);
            color: var(--background);
            border: none;
            padding: 12px 25px;
            border-radius: 30px;
            font-weight: 700;
            cursor: pointer;
            width: 80%;
            font-size: 1.05rem;
            transition: background-color 0.2s, transform 0.1s;
        }
        .btn-customize:hover { background-color: var(--primary); color: var(--text-light); }
        .btn-customize:active { transform: scale(0.95); }


        /* --- DATOS DEL CLIENTE (Mantenidos) --- */
        #clientDataSection {
            background: var(--card-bg);
            border: 2px solid var(--primary);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
        }
        #clientDataSection h2 {
            margin-top: 0;
            color: var(--primary);
            font-size: 1.4rem;
            border-bottom: 2px solid var(--secondary);
            padding-bottom: 5px;
            margin-bottom: 15px;
        }
        .input-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: var(--text-light);
            font-size: 0.9rem;
        }
        .input-group input:not([type="radio"]) {
            width: 90%;
            padding: 10px;
            margin-bottom: 15px;
            border-radius: 8px;
            border: 1px solid #444;
            background: #2A2A2A;
            color: var(--text-light);
            font-size: 1rem;
            box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.3);
            transition: border-color 0.3s;
        }
        .input-group input:focus {
            border-color: var(--secondary);
            outline: none;
        }
        
        .option-selector {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap; 
        }
        .option-selector label {
            flex: 1;
            padding: 10px;
            text-align: center;
            border-radius: 8px;
            border: 2px solid var(--text-dark);
            cursor: pointer;
            font-weight: 700;
            color: var(--text-dark);
            transition: all 0.3s;
            min-width: 100px; 
        }
        .option-selector input[type="radio"] {
            display: none;
        }
        .option-selector input[type="radio"]:checked + label {
            background-color: var(--secondary);
            border-color: var(--secondary);
            color: var(--background);
            box-shadow: 0 0 10px var(--secondary);
        }

        #changeInputGroup {
            transition: all 0.3s;
        }

        /* --- MODAL GENERAL Y COMPONENTES (MANTENIDOS) --- */
        .modal-overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            justify-content: center;
            align-items: flex-end;
            z-index: 1000;
        }

        .modal-content {
            background: var(--card-bg);
            color: var(--text-dark);
            width: 100%;
            max-width: 600px;
            border-radius: 20px 20px 0 0;
            padding: 25px;
            max-height: 85vh;
            overflow-y: auto;
            animation: slideUp 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            position: relative;
        }
        .modal-content h2 { color: var(--secondary); }

        .ingredient-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        .qty-control { display: flex; align-items: center; gap: 10px; }
        .btn-circle {
            width: 35px; height: 35px; border-radius: 50%;
            border: 1px solid var(--secondary);
            background: var(--background);
            color: var(--secondary);
            font-weight: bold; cursor: pointer;
            display: flex; align-items: center; justify-content: center;
            font-size: 1.2rem;
        }
        .btn-circle:active { background: var(--secondary); color: var(--background); }

        .cart-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: #2A2A2A;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 10px;
            border-left: 5px solid var(--primary);
        }
        
        .cart-item-details strong { display: block; font-size: 1.15rem; color: var(--text-light); }
        .cart-item-details small { color: var(--text-dark); font-size: 0.9rem; display: block; }

        .btn-delete {
            background-color: var(--danger);
            color: var(--text-light);
            border: none;
            width: 40px; height: 40px;
            border-radius: 50%;
            cursor: pointer;
            display: flex; align-items: center; justify-content: center;
            margin-left: 10px;
            font-size: 1.2rem;
        }

        .btn-add-cart {
            background-color: var(--primary);
            color: var(--text-light); width: 100%; padding: 15px;
            border: none; border-radius: 10px; font-size: 1.1rem;
            margin-top: 20px; cursor: pointer;
            transition: background-color 0.2s;
        }

        .btn-close {
            background: transparent; border: none; font-size: 1.8rem;
            position: absolute; top: 15px; right: 20px; cursor: pointer; 
            color: var(--text-dark);
        }

        /* --- BARRA INFERIOR (CARRITO) --- */
        .bottom-bar {
            position: fixed; bottom: 0; left: 0; width: 100%;
            background: #000000;
            box-shadow: 0 -4px 15px rgba(0, 0, 0, 0.6);
            padding: 15px; 
            display: flex; flex-direction: column; gap: 10px;
            box-sizing: border-box; z-index: 500;
        }

        .bar-actions {
            display: flex; justify-content: space-between; width: 100%; gap: 10px;
        }

        .btn-view-cart {
            background-color: var(--secondary);
            color: var(--background);
            flex: 1; padding: 15px; border-radius: 30px;
            border: none; font-weight: bold; cursor: pointer;
            text-align: center;
            transition: background-color 0.2s;
        }

        .btn-whatsapp {
            background-color: var(--success);
            color: var(--text-light);
            flex: 2; padding: 15px; border-radius: 30px;
            border: none; font-weight: bold; cursor: pointer;
            text-align: center;
            transition: background-color 0.2s;
        }
        
        /* --- Feedback de A√±adido (Toast) --- */
        #toast {
            visibility: hidden;
            min-width: 250px;
            background-color: #333;
            color: #fff;
            text-align: center;
            border-radius: 5px;
            padding: 16px;
            position: fixed;
            z-index: 1001;
            left: 50%;
            bottom: 100px;
            transform: translateX(-50%);
            font-size: 17px;
            box-shadow: 0 0 15px rgba(0,0,0,0.5);
        }
        #toast.show {
            visibility: visible;
            -webkit-animation: fadein 0.5s, fadeout 0.5s 2.5s;
            animation: fadein 0.5s, fadeout 0.5s 2.5s;
        }
        @-webkit-keyframes fadein { from {bottom: 0; opacity: 0;} to {bottom: 100px; opacity: 1;} }
        @keyframes fadein { from {bottom: 0; opacity: 0;} to {bottom: 100px; opacity: 1;} }
        @-webkit-keyframes fadeout { from {bottom: 100px; opacity: 1;} to {bottom: 0; opacity: 0;} }
        @keyframes fadeout { from {bottom: 100px; opacity: 1;} to {bottom: 0; opacity: 0;} }

    </style>
</head>
<body onload="updateAddressVisibility(); updateChangeVisibility(); updateCartUI();">

<header>
    <h1><span class="header-logo">üçî</span> Burger App üü£ Azure</h1>
</header>

<div class="container">
    <div id="app"></div>

    <div id="clientDataSection">
        <h2>Datos para el Pedido</h2>
        
        <div class="option-selector">
            <input type="radio" id="delivery" name="service_type" value="delivery" checked 
                onclick="updateAddressVisibility(); updateCartUI()">
            <label for="delivery">üõµ Env√≠o a Domicilio</label>
            
            <input type="radio" id="pickup" name="service_type" value="pickup" 
                onclick="updateAddressVisibility(); updateCartUI()">
            <label for="pickup">üèÉ Retiro en Local</label>
        </div>

        <div class="input-group">
            <label for="clientName">Tu Nombre Completo *</label>
            <input type="text" id="clientName" placeholder="Ej: Juan P√©rez" required>
        </div>

        <div class="input-group" id="addressInputGroup">
            <label for="clientAddress">Direcci√≥n de Entrega *</label>
            <input type="text" id="clientAddress" placeholder="Ej: Calle Falsa 123, Depto 4A" required>
        </div>
        
        <h2>M√©todo de Pago</h2>
        <div class="option-selector">
            <input type="radio" id="cash" name="payment_method" value="Efectivo" checked onclick="updateChangeVisibility()">
            <label for="cash">üíµ Efectivo</label>
            
            <input type="radio" id="transfer" name="payment_method" value="Transferencia" onclick="updateChangeVisibility()">
            <label for="transfer">üè¶ Transferencia</label>
            
            <input type="radio" id="mp" name="payment_method" value="Mercado Pago" onclick="updateChangeVisibility()">
            <label for="mp">üí≥ Mercado Pago</label>
        </div>

        <div class="input-group" id="changeInputGroup" style="display:none;">
            <label for="cashChange">¬øCon cu√°nto pagas? (Para el cambio)</label>
            <input type="number" id="cashChange" placeholder="Ej: 20000 (deja vac√≠o si pagas exacto)">
        </div>

    </div>
</div>

<div class="bottom-bar" id="cartBar">
    <div style="text-align: center; font-weight: bold; font-size: 1.2rem; color: var(--text-light);">
        Total: $<span id="cartTotal">0</span> (<span id="cartCount">0</span> items)
    </div>
    <div class="bar-actions">
        <button class="btn-view-cart" onclick="openCartModal()">Ver/Borrar üìù</button>
        <button class="btn-whatsapp" onclick="sendOrder()">Pedir por WhatsApp üì±</button>
    </div>
</div>

<div class="modal-overlay" id="modalCustomize">
    <div class="modal-content">
        <button class="btn-close" onclick="closeModal('modalCustomize')">&times;</button>
        <h2 id="modalTitle">Personalizar</h2>
        <p style="color:var(--secondary);">Base: $<span id="modalBasePrice">0</span></p>
        <div id="ingredientsList"></div>
        <div style="margin-top: 20px; text-align: right; font-weight: bold; font-size: 1.1rem; color: var(--text-light);">
            Subtotal: $<span id="modalSubtotal">0</span>
        </div>
        <button class="btn-add-cart" onclick="confirmAddToCart()">Confirmar Item</button>
    </div>
</div>

<div class="modal-overlay" id="modalCart">
    <div class="modal-content">
        <button class="btn-close" onclick="closeModal('modalCart')">&times;</button>
        <h2>Tu Pedido</h2>
        <div id="cartItemsList" style="margin-bottom: 20px;">
            </div>
        <div style="display:flex; gap:10px;">
            <button class="btn-view-cart" style="flex:1; background-color: var(--danger);" onclick="emptyCart()">Vaciar Carrito üóëÔ∏è</button>
            <button class="btn-view-cart" style="flex:1;" onclick="closeModal('modalCart')">Seguir Pidiendo</button>
        </div>
    </div>
</div>

<div id="toast">‚úÖ ¬°Producto a√±adido!</div>

<script>
    // --- 1. CONFIGURACI√ìN DEL NEGOCIO (¬°EDITA ESTO!) ---
    const PHONE_NUMBER = "5493886032588"; 
    const DELIVERY_FEE = 1500; 

    // DATOS DE PAGO DEL NEGOCIO
    const PAYMENT_DETAILS = {
        alias: "BURGER.APP.AZURE", // Alias CBU/CVU
        cbu: "0123456789012345678901", // CBU/CVU
        mpTag: "@BurgerAzureMP" // Tag de Mercado Pago o Link de pago
    };
    
    // --- 2. DATOS DE PRODUCTOS (¬°NUEVO: AHORA CON RUTAS DE IMAGEN!) ---
    const products = [
        {
            id: 1, name: "Hamburguesa Simple", price: 7000, 
            img: "./img/burger-simple.png", // <--- RUTA DE IMAGEN
            desc: "Pan, Carne, Lechuga, Tomate.",
            ingredients: [
                { name: "Medall√≥n de Carne", type: "meat", qty: 1 },
                { name: "Lechuga", type: "veg", qty: 1 },
                { name: "Tomate", type: "veg", qty: 1 },
                { name: "Pan", type: "base", qty: 1 }
            ]
        },
        {
            id: 2, name: "Hamburguesa Cheese", price: 10000, 
            img: "./img/burger-cheese.png", // <--- RUTA DE IMAGEN
            desc: "Pan, Carne, Cheddar, Cebolla Caramelizada.",
            ingredients: [
                { name: "Medall√≥n de Carne", type: "meat", qty: 1 },
                { name: "Cheddar", type: "veg", qty: 1 },
                { name: "Cebolla Caramelizada", type: "veg", qty: 1 },
                { name: "Pan", type: "base", qty: 1 }
            ]
        },
        {
            id: 3, name: "Hamburguesa Bacon Fries", price: 15000, 
            img: "./img/burger-baconfries.png", // <--- RUTA DE IMAGEN
            desc: "Pan, Carne, Cheddar, Papas Fritas, Bacon.",
            ingredients: [
                { name: "Medall√≥n de Carne", type: "meat", qty: 1 },
                { name: "Cheddar", type: "veg", qty: 1 },
                { name: "Bacon", type: "veg", qty: 1 },
                { name: "Papas Fritas", type: "veg", qty: 1 },
                { name: "Pan", type: "base", qty: 1 }
            ]
        }
    ];

    let cart = []; 
    let currentSelection = null; 

    // --- 3. FUNCIONES DE L√ìGICA DE INTERFAZ (UI) ---
    
    function updateAddressVisibility() {
        const deliveryChecked = document.getElementById('delivery').checked;
        const addressGroup = document.getElementById('addressInputGroup');
        const addressInput = document.getElementById('clientAddress');
        
        if (deliveryChecked) {
            addressGroup.style.display = 'block';
            addressInput.required = true;
        } else {
            addressGroup.style.display = 'none';
            addressInput.required = false;
        }
    }
    
    function updateChangeVisibility() {
        const cashChecked = document.getElementById('cash').checked;
        const changeGroup = document.getElementById('changeInputGroup');
        const changeInput = document.getElementById('cashChange');

        if (cashChecked) {
            changeGroup.style.display = 'block';
        } else {
            changeGroup.style.display = 'none';
            changeInput.value = ""; 
        }
    }

    // --- 4. FUNCIONES PRINCIPALES (MODALES/CARRITO) ---
    
    function init() {
        const app = document.getElementById('app');
        app.innerHTML = products.map(p => `
            <div class="product-card">
                <div class="product-img-wrapper"> 
                    <img src="${p.img}" alt="${p.name}"> 
                </div>
                <div class="product-info">
                    <h2>${p.name}</h2>
                    <p>${p.desc}</p>
                    <div class="price">$${p.price.toLocaleString()}</div>
                </div>
                <button class="btn-customize" onclick="openCustomizeModal(${p.id})">Agregar / Editar</button>
            </div>
        `).join('');
    }

    function openCustomizeModal(productId) {
        const product = products.find(p => p.id === productId);
        const ingredientsCopy = product.ingredients.map(i => ({...i}));

        currentSelection = {
            id: product.id,
            name: product.name,
            basePrice: product.price,
            ingredients: ingredientsCopy
        };

        document.getElementById('modalTitle').innerText = product.name;
        document.getElementById('modalBasePrice').innerText = product.price.toLocaleString();
        renderIngredients();
        updateModalTotal();
        document.getElementById('modalCustomize').style.display = 'flex';
    }

    function closeModal(modalId) {
        document.getElementById(modalId).style.display = 'none';
        if(modalId === 'modalCustomize') currentSelection = null;
    }

    function renderIngredients() {
        const list = document.getElementById('ingredientsList');
        list.innerHTML = currentSelection.ingredients.map((ing, index) => {
            if(ing.name === "Pan") return ''; 
            const extraCostText = ing.type === 'meat' ? "(+$1000)" : "(+$200)";
            const qtyColor = ing.qty === 0 ? 'color:#888' : 'color:var(--text-light)';
            
            return `
            <div class="ingredient-row" style="${qtyColor}">
                <div><strong>${ing.name}</strong> <small style="color:#666">Extra ${extraCostText}</small></div>
                <div class="qty-control">
                    <button class="btn-circle" onclick="changeQty(${index}, -1)">-</button>
                    <span>${ing.qty}</span>
                    <button class="btn-circle" onclick="changeQty(${index}, 1)">+</button>
                </div>
            </div>`;
        }).join('');
    }

    function changeQty(index, delta) {
        const ing = currentSelection.ingredients[index];
        if (ing.qty + delta < 0) return;
        ing.qty += delta;
        renderIngredients();
        updateModalTotal();
    }

    function updateModalTotal() {
        const originalProduct = products.find(p => p.id === currentSelection.id);
        let extraCost = 0;

        currentSelection.ingredients.forEach(ing => {
            const originalIng = originalProduct.ingredients.find(i => i.name === ing.name);
            if (!originalIng) return;

            if (ing.qty > originalIng.qty) {
                const diff = ing.qty - originalIng.qty;
                extraCost += diff * (ing.type === 'meat' ? 1000 : 200);
            }
        });

        const total = currentSelection.basePrice + extraCost;
        document.getElementById('modalSubtotal').innerText = total.toLocaleString();
        currentSelection.finalPrice = total;
    }

    function confirmAddToCart() {
        const originalProduct = products.find(p => p.id === currentSelection.id);
        let mods = [];

        currentSelection.ingredients.forEach(ing => {
            const originalIng = originalProduct.ingredients.find(i => i.name === ing.name);
            if (!originalIng) return;

            if (ing.qty > originalIng.qty) {
                const cost = (ing.qty - originalIng.qty) * (ing.type === 'meat' ? 1000 : 200);
                mods.push(`+ ${ing.qty - originalIng.qty} ${ing.name} (+ $${cost.toLocaleString()})`);
            } else if (ing.qty < originalIng.qty) {
                mods.push(ing.qty === 0 ? `üö´ SIN ${ing.name}` : `‚ûñ MENOS ${ing.name}`);
            }
        });

        cart.push({ ...currentSelection, mods: mods });
        updateCartUI();
        closeModal('modalCustomize');
        showToast("‚úÖ ¬°Producto a√±adido!");
    }
    
    function openCartModal() {
        if(cart.length === 0) {
            showToast("El carrito est√° vac√≠o. ¬°A√±ade una Burger!");
            return;
        }
        renderCartList();
        document.getElementById('modalCart').style.display = 'flex';
    }

    function renderCartList() {
        const list = document.getElementById('cartItemsList');
        if(cart.length === 0) {
            list.innerHTML = "<p style='text-align:center; padding: 20px; color: var(--danger);'>No tienes nada en el pedido.</p>";
            return;
        }

        list.innerHTML = cart.map((item, index) => {
            const modsHtml = item.mods.length > 0 ? 
                `<small style="color:var(--text-dark); font-style:italic;">${item.mods.join(' | ')}</small>` : 
                `<small style="color:var(--secondary)">Cl√°sica</small>`;

            return `
            <div class="cart-item">
                <div class="cart-item-details">
                    <strong>${item.name}</strong>
                    ${modsHtml}
                    <div style="color:var(--secondary); font-weight:700;">$${item.finalPrice.toLocaleString()}</div>
                </div>
                <button class="btn-delete" onclick="deleteFromCart(${index})">üóëÔ∏è</button>
            </div>
            `;
        }).join('');
    }

    function deleteFromCart(index) {
        cart.splice(index, 1);
        updateCartUI();
        renderCartList(); 
        if(cart.length === 0) {
            closeModal('modalCart');
            showToast("Carrito vaciado.", 2000);
        }
    }
    
    function emptyCart() {
        if(confirm("¬øEst√°s seguro que deseas vaciar todo el pedido?")) {
            cart = [];
            updateCartUI();
            closeModal('modalCart');
            showToast("Carrito vaciado por completo.", 2000);
        }
    }

    function updateCartUI() {
        const subtotal = cart.reduce((sum, item) => sum + item.finalPrice, 0);
        const serviceType = document.querySelector('input[name="service_type"]:checked').value;
        
        let deliveryCost = 0;
        if (serviceType === 'delivery') {
            deliveryCost = DELIVERY_FEE;
        }

        const grandTotal = subtotal + deliveryCost;

        document.getElementById('cartTotal').innerText = grandTotal.toLocaleString();
        document.getElementById('cart
